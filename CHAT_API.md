# API для чата с GigaChat

## Описание

Добавлены новые эндпоинты для чата с GigaChat, позволяющие пользователям задавать вопросы и получать рекомендации по улучшению навыков публичных выступлений.

## Эндпоинты

### 1. GET /chat/ui

Возвращает HTML-страницу с интерфейсом для чата.

### 2. POST /chat

Общий чат с GigaChat для вопросов по ораторскому искусству.

#### Заголовки
- `Content-Type: application/json`

#### Тело запроса

```json
{
  "messages": [
    {
      "role": "user",
      "content": "Как улучшить темп моей речи?"
    }
  ],
  "temperature": 0.7,
  "max_tokens": 1000
}
```

#### Параметры
- `messages` (обязательный): массив сообщений в формате [role, content]
- `temperature` (опционально): температура модели (по умолчанию 0.7)
- `max_tokens` (опционально): максимальное количество токенов (по умолчанию 1000)

#### Ответ

```json
{
  "response": "Текст ответа от GigaChat",
  "model": "название_модели",
  "tokens_used": 150
}
```

### 3. POST /chat/analyze-followup

Чат с GigaChat по результатам конкретного анализа речи.

#### Заголовки
- `Content-Type: application/json`

#### Тело запроса

```json
{
  "messages": [
    {
      "role": "user",
      "content": "Как мне улучшить использование слов-паразитов?"
    }
  ],
  "analysis_id": "идентификатор_анализа",
  "temperature": 0.7,
  "max_tokens": 1000
}
```

#### Параметры
- `messages` (обязательный): массив сообщений в формате [role, content]
- `analysis_id` (опционально): ID анализа, к которому относятся вопросы
- `temperature` (опционально): температура модели (по умолчанию 0.7)
- `max_tokens` (опционально): максимальное количество токенов (по умолчанию 1000)

#### Ответ

```json
{
  "response": "Текст ответа от GigaChat",
  "model": "название_модели",
  "tokens_used": 200
}
```

## Использование

### Пример запроса для общего чата

```bash
curl -X POST "http://localhost:8000/chat" \
  -H "Content-Type: application/json" \
  -d '{
    "messages": [
      {
        "role": "user",
        "content": "Как мне улучшить структуру моего выступления?"
      }
    ]
  }'
```

### Пример запроса для follow-up чата

```bash
curl -X POST "http://localhost:8000/chat/analyze-followup" \
  -H "Content-Type: application/json" \
  -d '{
    "messages": [
      {
        "role": "user",
        "content": "Как мне улучшить темп речи, который был слишком быстрым согласно анализу?"
      }
    ],
    "analysis_id": "abc123"
  }'
```

## Структура сообщений

Каждое сообщение в массиве `messages` должно содержать:
- `role`: "user" для сообщений пользователя или "assistant" для предыдущих ответов ассистента
- `content`: текст сообщения

## Ошибки

- `400 Bad Request`: Некорректные параметры запроса
- `422 Unprocessable Entity`: Ошибка валидации
- `500 Internal Server Error`: Ошибка на стороне сервера или проблемы с GigaChat API

## Требования

Для работы чата с GigaChat необходимо:
- Настроить переменные окружения для GigaChat API (API ключ и т.д.)
- Убедиться, что GigaChat включен в настройках приложения